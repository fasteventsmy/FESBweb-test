---
const { projects = [] } = Astro.props as { projects: any[] };
const items = projects ?? [];
---
<style>
  .rail { position: relative; }
  .scroller {
    display: grid;
    grid-auto-flow: column;
    gap: 1rem;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    padding: .5rem;
  }
  .card {
    width: min(72vw, 280px);
    scroll-snap-align: start;
    background: var(--card);
    border:1px solid rgba(255,255,255,.06);
    border-radius: 12px; overflow: hidden;
  }
  .thumb { aspect-ratio: 16/9; width:100%; object-fit: cover; background:#0b0b0b; }
  .meta { padding:.6rem .75rem; font-weight:700; font-size:.95rem; }
  .controls{ position:absolute; inset-block:0; pointer-events:none; display:flex; justify-content:space-between; align-items:center; }
  .arrow{
    pointer-events:auto; display:grid; place-items:center;
    width:42px;height:42px; border-radius:999px;
    background: rgba(18,18,18,.75); color:#fff; border:1px solid rgba(255,255,255,.2);
    backdrop-filter: blur(4px);
  }
</style>

<div class="rail">
  <div class="scroller" id="work-scroller">
    {items.map(p => (
      <a class="card" href={`/projects/${p.slug}/`} aria-label={p.title}>
        <img class="thumb" src={p.cover} alt={p.title} loading="lazy" />
        <div class="meta">{p.title}</div>
      </a>
    ))}
    <a class="card" href="/work" aria-label="See more of our work">
      <div class="thumb" style="display:grid;place-items:center;color:#fff;opacity:.9;">See more →</div>
      <div class="meta">See more of our work</div>
    </a>
  </div>
  <div class="controls" aria-hidden="true">
    <button class="arrow" type="button" on:click={() => scrollBy(-1)} style="margin-left:-6px;">‹</button>
    <button class="arrow" type="button" on:click={() => scrollBy(1)} style="margin-right:-6px;">›</button>
  </div>
</div>

<script>
  const rail = document.getElementById('work-scroller');
  function scrollBy(dir){ rail?.scrollBy({ left: dir * (rail.clientWidth * 0.9), behavior: 'smooth' }); }
</script>
